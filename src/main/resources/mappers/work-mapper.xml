<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "mybatis-3-mapper.dtd" >
<mapper namespace="workMapper">

	<resultMap id="holidayResult" type="Holiday">
		<id column="holi_no" property="holiNo" />
		<result column="user_no" property="userNo" />
		<result column ="user_name" property="userName" />
		<result column ="h_give" property="give" />
		<result column ="h_date" property="date" />
		<result column ="h_cause" property="cause" />
		<result column ="h_remain" property="remain" />
	</resultMap>
	
	<resultMap id="holidayResult2" type="Member">
		<id column="user_no" property="userNo" />
		<result column ="user_name" property="userName" />
		<result column ="give_day" property="giveDay" />
		<result column ="use_day" property="useDay" />
		<result column ="add_day" property="addDay" />
		
	</resultMap>

	<select id="selectHolidayList" resultMap="holidayResult2" >
		SELECT T1.USER_NO 
		     , T1.USER_NAME
		     , SUM ( CASE WHEN T2.H_CAUSE = '연차지급' THEN T2.H_GIVE ELSE 0 END ) AS GIVE_DAY
		     , SUM ( CASE WHEN T2.H_CAUSE = '연차사용' THEN T2.H_GIVE ELSE 0 END ) AS USE_DAY
		     , SUM ( CASE WHEN T2.H_CAUSE = '추가지급' THEN T2.H_GIVE ELSE 0 END ) AS ADD_DAY
		  FROM MEMBER T1
		  LEFT OUTER JOIN HOLIDAY T2  
		    ON T1.USER_NO = T2.USER_NO
		 GROUP BY T1.USER_NO  
		       , T1.USER_NAME 
		 ORDER BY T1.USER_NO ASC
	</select>
</mapper>